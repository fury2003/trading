//@version=5
indicator(title="Crypto - Ichimoku Future", overlay=true)

// ichi past line
isActiveKumo = input.bool(true, "Show Kumo", group="Display")
isActive26   = input.bool(true, "Show 26", group="Display")
isActive65   = input.bool(false, "Show 65", group="Display")
isActive129  = input.bool(true, "Show 129", group="Display")
isActive234  = input.bool(true, "Show 234", group="Display")

tenkan = input.int(9, minval=1, title="Tenkan-sen", group="Ichimoku Setting")
kijun = input.int(26, minval=1, title="Kijun-sen", group="Ichimoku Setting")
laggingSpan2Periods = input.int(52, minval=1, title="Lagging Span 2", group="Ichimoku Setting")
Periods26 = input.int(26, minval=1, title="Tiny Term Period", group="Ichimoku Setting")
Periods65 = input.int(65, minval=1, title="Short Term Period", group="Ichimoku Setting")
Periods129 = input.int(129, minval=1, title="Mid Term Period", group="Ichimoku Setting")
Periods234 = input.int(234, minval=1, title="Long Term Period", group="Ichimoku Setting")

f_avgLH(len, offset) => math.avg(ta.lowest(len-offset), ta.highest(len-offset))
f_avg(tk, kj) => math.avg(tk, kj)

//26 future
Next26_1 = f_avgLH(Periods26, 1)
Next26_2 = f_avgLH(Periods26, 2)
Next26_3 = f_avgLH(Periods26, 3)
Next26_4 = f_avgLH(Periods26, 4)
Next26_5 = f_avgLH(Periods26, 5)
Next26_6 = f_avgLH(Periods26, 6)
Next26_7 = f_avgLH(Periods26, 7)
Next26_8 = f_avgLH(Periods26, 8)
Next26_9 = f_avgLH(Periods26, 9)
Next26_10 = f_avgLH(Periods26, 10)
Next26_11 = f_avgLH(Periods26, 11)
Next26_12 = f_avgLH(Periods26, 12)
Next26_13 = f_avgLH(Periods26, 13)

//65 future
Next65_1 = f_avgLH(Periods65, 1)
Next65_2 = f_avgLH(Periods65, 2)
Next65_3 = f_avgLH(Periods65, 3)
Next65_4 = f_avgLH(Periods65, 4)
Next65_5 = f_avgLH(Periods65, 5)
Next65_6 = f_avgLH(Periods65, 6)
Next65_7 = f_avgLH(Periods65, 7)
Next65_8 = f_avgLH(Periods65, 8)
Next65_9 = f_avgLH(Periods65, 9)
Next65_10 = f_avgLH(Periods65, 10)
Next65_11 = f_avgLH(Periods65, 11)
Next65_12 = f_avgLH(Periods65, 12)
Next65_13 = f_avgLH(Periods65, 13)

//129
Next129_1 = f_avgLH(Periods129, 1)
Next129_2 = f_avgLH(Periods129, 2)
Next129_3 = f_avgLH(Periods129, 3)
Next129_4 = f_avgLH(Periods129, 4)
Next129_5 = f_avgLH(Periods129, 5)
Next129_6 = f_avgLH(Periods129, 6)
Next129_7 = f_avgLH(Periods129, 7)
Next129_8 = f_avgLH(Periods129, 8)
Next129_9 = f_avgLH(Periods129, 9)
Next129_10 = f_avgLH(Periods129, 10)
Next129_11 = f_avgLH(Periods129, 11)
Next129_12 = f_avgLH(Periods129, 12)
Next129_13 = f_avgLH(Periods129, 13)

//234
Next234_1 = f_avgLH(Periods234, 1)
Next234_2 = f_avgLH(Periods234, 2)
Next234_3 = f_avgLH(Periods234, 3)
Next234_4 = f_avgLH(Periods234, 4)
Next234_5 = f_avgLH(Periods234, 5)
Next234_6 = f_avgLH(Periods234, 6)
Next234_7 = f_avgLH(Periods234, 7)
Next234_8 = f_avgLH(Periods234, 8)
Next234_9 = f_avgLH(Periods234, 9)
Next234_10 = f_avgLH(Periods234, 10)
Next234_11 = f_avgLH(Periods234, 11)
Next234_12 = f_avgLH(Periods234, 12)
Next234_13 = f_avgLH(Periods234, 13)

// Future Kumo B = (Highest High + Lowest Low)/2     for 52 period and then shifted forward by 26 periods
KB_Next_1 = f_avgLH(laggingSpan2Periods, 1)
KB_Next_2 =  f_avgLH(laggingSpan2Periods, 2)
KB_Next_3 =  f_avgLH(laggingSpan2Periods, 3)
KB_Next_4 =  f_avgLH(laggingSpan2Periods, 4)
KB_Next_5 =  f_avgLH(laggingSpan2Periods, 5)
KB_Next_6 =  f_avgLH(laggingSpan2Periods, 6)

// Kumo SSA =(Tenkan Sen + KijWl Sen)/2    Shifted forward ni time 26 periods
TS_Next_1 = f_avgLH(tenkan, 1)
TS_Next_2 = f_avgLH(tenkan, 2)
TS_Next_3 = f_avgLH(tenkan, 3)
TS_Next_4 = f_avgLH(tenkan, 4)
TS_Next_5 = f_avgLH(tenkan, 5)
TS_Next_6 = f_avgLH(tenkan, 6)

KJ_Next_1 = f_avgLH(kijun, 1)
KJ_Next_2 = f_avgLH(kijun, 2)
KJ_Next_3 = f_avgLH(kijun, 3)
KJ_Next_4 = f_avgLH(kijun, 4)
KJ_Next_5 = f_avgLH(kijun, 5)
KJ_Next_6 = f_avgLH(kijun, 6)

Next_KumoA_1 = f_avg(KJ_Next_1, TS_Next_1)
Next_KumoA_2 = f_avg(KJ_Next_2, TS_Next_2)
Next_KumoA_3 = f_avg(KJ_Next_3, TS_Next_3)
Next_KumoA_4 = f_avg(KJ_Next_4, TS_Next_4)
Next_KumoA_5 = f_avg(KJ_Next_5, TS_Next_5)
Next_KumoA_6 = f_avg(KJ_Next_6, TS_Next_6)

// Plot Kumo SSA
plot(isActiveKumo?Next_KumoA_1:na, color=#0cb71a, linewidth=1, offset=26, show_last=1, title="Kumo SSA")
plot(isActiveKumo?Next_KumoA_2:na, color=#0cb71a, linewidth=1, offset=27, show_last=1, title="Kumo SSA")
plot(isActiveKumo?Next_KumoA_3:na, color=#0cb71a, linewidth=1, offset=28, show_last=1, title="Kumo SSA")
plot(isActiveKumo?Next_KumoA_4:na, color=#0cb71a, linewidth=1, offset=29, show_last=1, title="Kumo SSA")
plot(isActiveKumo?Next_KumoA_5:na, color=#0cb71a, linewidth=1, offset=30, show_last=1, title="Kumo SSA")
plot(isActiveKumo?Next_KumoA_6:na, color=#0cb71a, linewidth=1, offset=31, show_last=1, title="Kumo SSA")

// Plot Kumo SSB
plot(isActiveKumo?KB_Next_1:na, color=#FF5252, linewidth=1, offset=26, show_last=1, title="Kumo SSB")
plot(isActiveKumo?KB_Next_2:na, color=#FF5252, linewidth=1, offset=27, show_last=1, title="Kumo SSB")
plot(isActiveKumo?KB_Next_3:na, color=#FF5252, linewidth=1, offset=28, show_last=1, title="Kumo SSB")
plot(isActiveKumo?KB_Next_4:na, color=#FF5252, linewidth=1, offset=29, show_last=1, title="Kumo SSB")
plot(isActiveKumo?KB_Next_5:na, color=#FF5252, linewidth=1, offset=30, show_last=1, title="Kumo SSB")
plot(isActiveKumo?KB_Next_6:na, color=#FF5252, linewidth=1, offset=31, show_last=1, title="Kumo SSB")

//26
plot(isActive26?Next26_1:na, color=#9B352E, linewidth=1, title="Line 26", offset=1, show_last=1)
plot(isActive26?Next26_2:na, color=#9B352E, linewidth=1, title="Line 26", offset=2, show_last=1)
plot(isActive26?Next26_3:na, color=#9B352E, linewidth=1, title="Line 26", offset=3, show_last=1)
plot(isActive26?Next26_4:na, color=#9B352E, linewidth=1, title="Line 26", offset=4, show_last=1)
plot(isActive26?Next26_5:na, color=#9B352E, linewidth=1, title="Line 26", offset=5, show_last=1)
plot(isActive26?Next26_6:na, color=#9B352E, linewidth=1, title="Line 26", offset=6, show_last=1)
plot(isActive26?Next26_7:na, color=#9B352E, linewidth=1, title="Line 26", offset=7, show_last=1)
plot(isActive26?Next26_8:na, color=#9B352E, linewidth=1, title="Line 26", offset=8, show_last=1)
plot(isActive26?Next26_9:na, color=#9B352E, linewidth=1, title="Line 26", offset=9, show_last=1)
plot(isActive26?Next26_10:na, color=#9B352E, linewidth=1, title="Line 26", offset=10, show_last=1)
plot(isActive26?Next26_11:na, color=#9B352E, linewidth=1, title="Line 26", offset=11, show_last=1)
plot(isActive26?Next26_12:na, color=#9B352E, linewidth=1, title="Line 26", offset=12, show_last=1)
plot(isActive26?Next26_13:na, color=#9B352E, linewidth=1, title="Line 26", offset=13, show_last=1)

//65
plot(isActive65?Next65_1:na, color=#8893D9, linewidth=1, title="Line 65", offset=1, show_last=1)
plot(isActive65?Next65_2:na, color=#8893D9, linewidth=1, title="Line 65", offset=2, show_last=1)
plot(isActive65?Next65_3:na, color=#8893D9, linewidth=1, title="Line 65", offset=3, show_last=1)
plot(isActive65?Next65_4:na, color=#8893D9, linewidth=1, title="Line 65", offset=4, show_last=1)
plot(isActive65?Next65_5:na, color=#8893D9, linewidth=1, title="Line 65", offset=5, show_last=1)
plot(isActive65?Next65_6:na, color=#8893D9, linewidth=1, title="Line 65", offset=6, show_last=1)
plot(isActive65?Next65_7:na, color=#8893D9, linewidth=1, title="Line 65", offset=7, show_last=1)
plot(isActive65?Next65_8:na, color=#8893D9, linewidth=1, title="Line 65", offset=8, show_last=1)
plot(isActive65?Next65_9:na, color=#8893D9, linewidth=1, title="Line 65", offset=9, show_last=1)
plot(isActive65?Next65_10:na, color=#8893D9, linewidth=1, title="Line 65", offset=10, show_last=1)
plot(isActive65?Next65_11:na, color=#8893D9, linewidth=1, title="Line 65", offset=11, show_last=1)
plot(isActive65?Next65_12:na, color=#8893D9, linewidth=1, title="Line 65", offset=12, show_last=1)
plot(isActive65?Next65_13:na, color=#8893D9, linewidth=1, title="Line 65", offset=13, show_last=1)

//129
plot(isActive129?Next129_1:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=1, show_last=1)
plot(isActive129?Next129_2:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=2, show_last=1)
plot(isActive129?Next129_3:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=3, show_last=1)
plot(isActive129?Next129_4:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=4, show_last=1)
plot(isActive129?Next129_5:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=5, show_last=1)
plot(isActive129?Next129_6:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=6, show_last=1)
plot(isActive129?Next129_7:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=7, show_last=1)
plot(isActive129?Next129_8:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=8, show_last=1)
plot(isActive129?Next129_9:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=9, show_last=1)
plot(isActive129?Next129_10:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=10, show_last=1)
plot(isActive129?Next129_11:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=11, show_last=1)
plot(isActive129?Next129_12:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=12, show_last=1)
plot(isActive129?Next129_13:na, color=#3E4EBD, linewidth=1, title="Line 129", offset=13, show_last=1)

//234
plot(isActive234?Next234_1:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=1, show_last=1)
plot(isActive234?Next234_2:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=2, show_last=1)
plot(isActive234?Next234_3:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=3, show_last=1)
plot(isActive234?Next234_4:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=4, show_last=1)
plot(isActive234?Next234_5:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=5, show_last=1)
plot(isActive234?Next234_6:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=6, show_last=1)
plot(isActive234?Next234_7:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=7, show_last=1)
plot(isActive234?Next234_8:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=8, show_last=1)
plot(isActive234?Next234_9:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=9, show_last=1)
plot(isActive234?Next234_10:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=10, show_last=1)
plot(isActive234?Next234_11:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=11, show_last=1)
plot(isActive234?Next234_12:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=12, show_last=1)
plot(isActive234?Next234_13:na, color=#3E4EBD, linewidth=1, title="Line 234", offset=13, show_last=1)